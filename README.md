# CH446Q/CH446X analog matrix switch

    Chip provides low cost sollution for switching analog or digital signals. Additional information can be found on [manufactuer's website](https://www.wch-ic.com/products/CH446.html) or in [datasheet](https://www.wch-ic.com/downloads/file/133.html?time=2023-07-04%2001:38:21&code=CnV1R6WxBnmSp8Wp81xUjh9WASIxq1sdDTYm3V95).

## Communication with the chip

    Library used serial communication with CH446x. Protocol is similar to SPI with one difference. It needs one additional pin(STB - strobe) for setting on/off link. We chose to bitbang this communication using 1 STM32 timer(featuring at least 1 channel) and 2 interrupts. Capture of logical signals generated by library are shown on the next picture.

![](/images/1.png)

## Code limitation

- **The code is untested** on the real hardware [in progress]. Datasheet doesn't provide lot of information for exaple about logical level voltage thresholds. 
- **There is no support for CH446X chip yet**. Code is a subject to change. 
- **Missing function documentation.** [working on]

## Using the library

. Code is a subject to change.

## Using the library

1. Copy `CH446_Lib` folder to your root project folder.
1. Setup include and source path.
1. Add `#include "Lib_STM32_CH446.h"` where you need it.
